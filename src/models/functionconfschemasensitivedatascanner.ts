/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { safeParse } from "../lib/schemas.js";
import { Result as SafeParseResult } from "../types/fp.js";
import { SDKValidationError } from "./errors/sdkvalidationerror.js";

export type FunctionConfSchemaSensitiveDataScannerRule = {
  /**
   * The ID of the ruleset to use for the scan
   */
  rulesetId: string;
  /**
   * A JavaScript expression or literal to replace the matching content. Capturing groups can be referenced as g1, g2, and so on, and event fields as event.<fieldName>.
   */
  replaceExpr: string;
  disabled?: boolean | undefined;
};

export type Flag = {
  name?: string | undefined;
  value: string;
};

export type FunctionConfSchemaSensitiveDataScanner = {
  rules?: Array<FunctionConfSchemaSensitiveDataScannerRule> | undefined;
  /**
   * Rulesets act on the events contained in these fields. Mitigation expressions apply to the scan results. Supports wildcards (*).
   */
  fields?: Array<string> | undefined;
  /**
   * Fields that the mitigation expression will not be applied to. Supports wildcards (*).
   */
  excludeFields?: Array<string> | undefined;
  /**
   * Fields to add when mitigation is applied to an event
   */
  flags?: Array<Flag> | undefined;
  /**
   * Add matching ruleset IDs to a field called "__detected"
   */
  includeDetectedRules?: boolean | undefined;
  backgroundDetection?: boolean | undefined;
};

/** @internal */
export const FunctionConfSchemaSensitiveDataScannerRule$inboundSchema:
  z.ZodType<FunctionConfSchemaSensitiveDataScannerRule, z.ZodTypeDef, unknown> =
    z.object({
      rulesetId: z.string(),
      replaceExpr: z.string(),
      disabled: z.boolean().optional(),
    });
/** @internal */
export type FunctionConfSchemaSensitiveDataScannerRule$Outbound = {
  rulesetId: string;
  replaceExpr: string;
  disabled?: boolean | undefined;
};

/** @internal */
export const FunctionConfSchemaSensitiveDataScannerRule$outboundSchema:
  z.ZodType<
    FunctionConfSchemaSensitiveDataScannerRule$Outbound,
    z.ZodTypeDef,
    FunctionConfSchemaSensitiveDataScannerRule
  > = z.object({
    rulesetId: z.string(),
    replaceExpr: z.string(),
    disabled: z.boolean().optional(),
  });

export function functionConfSchemaSensitiveDataScannerRuleToJSON(
  functionConfSchemaSensitiveDataScannerRule:
    FunctionConfSchemaSensitiveDataScannerRule,
): string {
  return JSON.stringify(
    FunctionConfSchemaSensitiveDataScannerRule$outboundSchema.parse(
      functionConfSchemaSensitiveDataScannerRule,
    ),
  );
}
export function functionConfSchemaSensitiveDataScannerRuleFromJSON(
  jsonString: string,
): SafeParseResult<
  FunctionConfSchemaSensitiveDataScannerRule,
  SDKValidationError
> {
  return safeParse(
    jsonString,
    (x) =>
      FunctionConfSchemaSensitiveDataScannerRule$inboundSchema.parse(
        JSON.parse(x),
      ),
    `Failed to parse 'FunctionConfSchemaSensitiveDataScannerRule' from JSON`,
  );
}

/** @internal */
export const Flag$inboundSchema: z.ZodType<Flag, z.ZodTypeDef, unknown> = z
  .object({
    name: z.string().optional(),
    value: z.string(),
  });
/** @internal */
export type Flag$Outbound = {
  name?: string | undefined;
  value: string;
};

/** @internal */
export const Flag$outboundSchema: z.ZodType<Flag$Outbound, z.ZodTypeDef, Flag> =
  z.object({
    name: z.string().optional(),
    value: z.string(),
  });

export function flagToJSON(flag: Flag): string {
  return JSON.stringify(Flag$outboundSchema.parse(flag));
}
export function flagFromJSON(
  jsonString: string,
): SafeParseResult<Flag, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Flag$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Flag' from JSON`,
  );
}

/** @internal */
export const FunctionConfSchemaSensitiveDataScanner$inboundSchema: z.ZodType<
  FunctionConfSchemaSensitiveDataScanner,
  z.ZodTypeDef,
  unknown
> = z.object({
  rules: z.array(
    z.lazy(() => FunctionConfSchemaSensitiveDataScannerRule$inboundSchema),
  ).optional(),
  fields: z.array(z.string()).optional(),
  excludeFields: z.array(z.string()).optional(),
  flags: z.array(z.lazy(() => Flag$inboundSchema)).optional(),
  includeDetectedRules: z.boolean().optional(),
  backgroundDetection: z.boolean().optional(),
});
/** @internal */
export type FunctionConfSchemaSensitiveDataScanner$Outbound = {
  rules?:
    | Array<FunctionConfSchemaSensitiveDataScannerRule$Outbound>
    | undefined;
  fields?: Array<string> | undefined;
  excludeFields?: Array<string> | undefined;
  flags?: Array<Flag$Outbound> | undefined;
  includeDetectedRules?: boolean | undefined;
  backgroundDetection?: boolean | undefined;
};

/** @internal */
export const FunctionConfSchemaSensitiveDataScanner$outboundSchema: z.ZodType<
  FunctionConfSchemaSensitiveDataScanner$Outbound,
  z.ZodTypeDef,
  FunctionConfSchemaSensitiveDataScanner
> = z.object({
  rules: z.array(
    z.lazy(() => FunctionConfSchemaSensitiveDataScannerRule$outboundSchema),
  ).optional(),
  fields: z.array(z.string()).optional(),
  excludeFields: z.array(z.string()).optional(),
  flags: z.array(z.lazy(() => Flag$outboundSchema)).optional(),
  includeDetectedRules: z.boolean().optional(),
  backgroundDetection: z.boolean().optional(),
});

export function functionConfSchemaSensitiveDataScannerToJSON(
  functionConfSchemaSensitiveDataScanner:
    FunctionConfSchemaSensitiveDataScanner,
): string {
  return JSON.stringify(
    FunctionConfSchemaSensitiveDataScanner$outboundSchema.parse(
      functionConfSchemaSensitiveDataScanner,
    ),
  );
}
export function functionConfSchemaSensitiveDataScannerFromJSON(
  jsonString: string,
): SafeParseResult<FunctionConfSchemaSensitiveDataScanner, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) =>
      FunctionConfSchemaSensitiveDataScanner$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'FunctionConfSchemaSensitiveDataScanner' from JSON`,
  );
}
