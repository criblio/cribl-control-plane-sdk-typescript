/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { safeParse } from "../lib/schemas.js";
import { Result as SafeParseResult } from "../types/fp.js";
import { SDKValidationError } from "./errors/sdkvalidationerror.js";

export type FunctionConfSchemaSensitiveDataScannerRule = {
  /**
   * The ID of the ruleset to use for the scan
   */
  rulesetId: string;
  /**
   * A JavaScript expression or literal to replace the matching content. Capturing groups can be referenced as g1, g2, and so on, and event fields as event.<fieldName>.
   */
  replaceExpr: string;
  disabled: boolean;
};

export type FunctionConfSchemaSensitiveDataScannerFlag = {
  name?: string | undefined;
  value: string;
};

export type FunctionConfSchemaSensitiveDataScanner = {
  rules?: Array<FunctionConfSchemaSensitiveDataScannerRule> | undefined;
  /**
   * Rulesets act on the events contained in these fields. Mitigation expressions apply to the scan results. Supports wildcards (*).
   */
  fields?: Array<string> | undefined;
  /**
   * Fields that the mitigation expression will not be applied to. Supports wildcards (*).
   */
  excludeFields?: Array<string> | undefined;
  /**
   * Fields to add when mitigation is applied to an event
   */
  flags?: Array<FunctionConfSchemaSensitiveDataScannerFlag> | undefined;
  /**
   * Add matching ruleset IDs to a field called "__detected"
   */
  includeDetectedRules: boolean;
  backgroundDetection: boolean;
};

/** @internal */
export const FunctionConfSchemaSensitiveDataScannerRule$inboundSchema:
  z.ZodType<FunctionConfSchemaSensitiveDataScannerRule, z.ZodTypeDef, unknown> =
    z.object({
      rulesetId: z.string(),
      replaceExpr: z.string().default("'REDACTED'"),
      disabled: z.boolean().default(false),
    });

export function functionConfSchemaSensitiveDataScannerRuleFromJSON(
  jsonString: string,
): SafeParseResult<
  FunctionConfSchemaSensitiveDataScannerRule,
  SDKValidationError
> {
  return safeParse(
    jsonString,
    (x) =>
      FunctionConfSchemaSensitiveDataScannerRule$inboundSchema.parse(
        JSON.parse(x),
      ),
    `Failed to parse 'FunctionConfSchemaSensitiveDataScannerRule' from JSON`,
  );
}

/** @internal */
export const FunctionConfSchemaSensitiveDataScannerFlag$inboundSchema:
  z.ZodType<FunctionConfSchemaSensitiveDataScannerFlag, z.ZodTypeDef, unknown> =
    z.object({
      name: z.string().optional(),
      value: z.string(),
    });

export function functionConfSchemaSensitiveDataScannerFlagFromJSON(
  jsonString: string,
): SafeParseResult<
  FunctionConfSchemaSensitiveDataScannerFlag,
  SDKValidationError
> {
  return safeParse(
    jsonString,
    (x) =>
      FunctionConfSchemaSensitiveDataScannerFlag$inboundSchema.parse(
        JSON.parse(x),
      ),
    `Failed to parse 'FunctionConfSchemaSensitiveDataScannerFlag' from JSON`,
  );
}

/** @internal */
export const FunctionConfSchemaSensitiveDataScanner$inboundSchema: z.ZodType<
  FunctionConfSchemaSensitiveDataScanner,
  z.ZodTypeDef,
  unknown
> = z.object({
  rules: z.array(
    z.lazy(() => FunctionConfSchemaSensitiveDataScannerRule$inboundSchema),
  ).optional(),
  fields: z.array(z.string()).optional(),
  excludeFields: z.array(z.string()).optional(),
  flags: z.array(
    z.lazy(() => FunctionConfSchemaSensitiveDataScannerFlag$inboundSchema),
  ).optional(),
  includeDetectedRules: z.boolean().default(true),
  backgroundDetection: z.boolean().default(false),
});

export function functionConfSchemaSensitiveDataScannerFromJSON(
  jsonString: string,
): SafeParseResult<FunctionConfSchemaSensitiveDataScanner, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) =>
      FunctionConfSchemaSensitiveDataScanner$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'FunctionConfSchemaSensitiveDataScanner' from JSON`,
  );
}
